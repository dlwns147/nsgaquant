# from matplotlib import pyplot as plt

# # owq_llama_2_gemv_hf

# # 표로 그릴 것.

# colors = [
#     '#FF6663',
#     '#939393',
#     '#C83C04',
#     '#378375',
#     '#6699FF',
#     '#FACA00',
#     '#2351AB',
# ]

# fig_path='acl/experiment/continous_result.png'

# fig, axes = plt.subplots(nrows=3, ncols=1, figsize=(5, 15)) 
# fig.subplots_adjust(hspace=0.5, wspace=0.1)

# our_7b_bits = [2.20369171, 2.40349741, 2.60427461, 2.80246114, 2.99740933, 3.20498705, 3.40123057, 3.60103627, 3.80310881, 3.99222798]
# our_7b_w2 = [9.70293808, 8.307990074, 7.460319519, 6.713390827, 6.187410831, 6.020772934, 5.869136333, 5.793658257, 5.68144989, 5.597347736]
# our_7b_c4 = [12.82921791, 10.93458462, 9.837593079, 8.866043091, 8.225736618, 8.009811401, 7.793493271, 7.64744854, 7.530736923, 7.44137764]
# our_7b_acc = [0.604282098, 0.625704665, 0.637907708, 0.666701336, 0.677821555, 0.682099624, 0.686616407, 0.686102525, 0.688649375, 0.697427872]

# bitstack_7b_bits = [2.2, 2.4, 2.6, 2.8, 3, 3.2, 3.4, 3.6, 3.8, 4]
# bitstack_7b_w2 = [9.175833702, 8.297012329, 7.791053772, 7.414270401, 7.098052025, 6.766305923, 6.555026531, 6.430410385, 6.334755898, 6.266643047]
# bitstack_7b_c4 = [12.56320381, 11.26459026, 10.59273624, 10.04853344, 9.664886475, 9.113240242, 8.809690475, 8.641955376, 8.511131287, 8.385821342]
# bitstack_7b_acc = [0.601391018, 0.619275265, 0.627521764, 0.637491537, 0.643394393, 0.656135069, 0.662427668, 0.667206655, 0.672052206, 0.674013289]

# pbllm_7b_bits = [2.197, 2.4, 2.603, 2.799, 3.002, 3.198, 3.401, 3.597, 3.8, 4.003]
# pbllm_7b_w2 = [25.409021, 17.224394, 13.824484, 11.35747, 9.181018, 8.061, 7.414878, 6.925223, 6.602927, 6.332662]
# pbllm_7b_c4 = [32.068573, 22.882645, 17.609436, 14.669633, 12.173552, 10.701463, 9.805017, 9.174158, 8.767661, 8.437231]
# pbllm_7b_acc = [0.439466138, 0.480417192, 0.536299553, 0.578924823, 0.613636868, 0.634068865, 0.646246926, 0.659146108, 0.673270014, 0.678828369]

# owq_7b_bits = [2.2, 2.4, 2.6, 2.8, 3.2, 3.4, 3.6, 3.8]
# owq_7b_w2 = [9.512156487, 9.513555527, 9.25275135, 9.089015007, 6.015853405, 5.974658489, 5.961352825, 5.967914104]
# owq_7b_c4 = [11.93916416, 11.70453358, 11.55443287, 11.22610092, 7.941548347, 7.913356781, 7.89141798, 7.887867451]
# owq_7b_acc = [0.60127132, 0.609347297, 0.611218543, 0.616280351, 0.690211332, 0.689057585, 0.687197822, 0.688208984]

# # axes[0].plot(pbllm_7b_bits, pbllm_7b_w2, label='PB-LLM', linestyle='-')
# # axes[0].plot(owq_7b_bits, owq_7b_w2, label='OWQ', linestyle='-')
# # axes[0].plot(bitstack_7b_bits, bitstack_7b_w2, label='BitStack', linestyle='-')
# # axes[0].plot(our_7b_bits, our_7b_w2, label='Our', linestyle='-')
# # axes[0].plot(pbllm_7b_bits, pbllm_7b_c4, label='PB-LLM', linestyle='-')
# # # axes[0].plot(owq_7b_bits, owq_7b_c4, label='OWQ', linestyle='-')
# # axes[0].plot(bitstack_7b_bits, bitstack_7b_c4, label='BitStack', linestyle='-')
# # axes[0].plot(our_7b_bits, our_7b_c4, label='Our', linestyle='-')
# axes[0].scatter(pbllm_7b_bits, pbllm_7b_c4, s=5, label='PB-LLM', facecolors='none')
# # axes[0].plot(owq_7b_bits, owq_7b_c4, label='OWQ', linestyle='-')
# axes[0].scatter(bitstack_7b_bits, bitstack_7b_c4, s=5,label='BitStack', facecolors='none')
# axes[0].scatter(our_7b_bits, our_7b_c4, s=5, label='Our', facecolors='none')
# axes[0].set_title('Llama 2 7B')
# axes[0].set_xlabel('Bits')
# axes[0].set_ylabel('Perplexity')
# axes[0].grid(c='0.8')
# # axes[0].legend(loc='upper right')
# axes[0].legend()
# axes[0].set_yscale('log')

# ax = axes[0].twinx()
# ax.scatter(pbllm_7b_bits, pbllm_7b_acc, s=5)
# # ax.scatter(owq_7b_bits, owq_7b_acc, s=5)
# ax.scatter(bitstack_7b_bits, bitstack_7b_acc, s=5)
# ax.scatter(our_7b_bits, our_7b_acc, s=5)
# ax.set_ylabel('Acc.')
# ax.grid(c='0.8')


# pbllm_13b_bits = [2.197, 2.4, 2.603, 2.799, 3.002, 3.198, 3.401, 3.597, 3.8, 4.003]
# pbllm_13b_w2 = [49.662487, 21.767782, 12.027323, 9.540066, 7.770907, 6.957156, 6.444432, 6.03354, 5.794348, 5.621876]
# pbllm_13b_c4 = [53.145523, 28.799479, 16.243132, 13.139219, 10.783956, 9.700974, 8.908892, 8.274727, 7.935522, 7.717345]
# pbllm_13b_acc = [0.445306741, 0.521918144, 0.608104881, 0.64488449, 0.671657683, 0.683852428, 0.695484065, 0.708052548, 0.717220212, 0.713828894]

# owq_13b_bits = [2.2, 2.4, 2.6, 2.8, 3.2, 3.4, 3.6, 3.8]
# owq_13b_w2 = [8.141159058, 7.90238905, 7.906852245, 7.644672871, 5.259451866, 5.233787537, 5.246657372, 5.222622395]
# owq_13b_c4 = [10.81324387, 10.55164051, 10.35543156, 10.24857807, 7.184574127, 7.174242496, 7.165292263, 7.144797802]
# owq_13b_acc = [0.649320442, 0.64854396, 0.652410135, 0.660048735, 0.718132311, 0.716591034, 0.724292107, 0.719481134]

# bitstack_13b_bits = [2.2, 2.4, 2.6, 2.8, 3, 3.2, 3.4, 3.6, 3.8, 4]
# bitstack_13b_w2 = [9.175833702, 8.297012329, 7.791053772, 7.414270401, 7.098052025, 6.766305923, 6.555026531, 6.430410385, 6.334755898, 6.266643047]
# bitstack_13b_c4 = [10.31787777, 9.537553787, 9.025455475, 8.665048599, 8.353291512, 7.974319458, 7.801470757, 7.675413132, 7.572425842, 7.49377346]
# bitstack_13b_acc = [0.62639496, 0.65044807, 0.666231766, 0.676121231, 0.682551099, 0.688576983, 0.695072416, 0.696956562, 0.70252, 0.700891267]

# our_13b_bits = [2.20309917, 2.40061983, 2.60392562, 2.80206612, 3.00165289, 3.20392562, 3.40123967, 3.60392562, 3.80041322, 3.98615702]
# our_13b_w2 = [7.209764004, 6.441867828, 5.988779068, 5.634430885, 5.374492168, 5.24823761, 5.157777786, 5.090263367, 5.024534225, 4.965404987]
# our_13b_c4 = [9.835852623, 8.829443932, 8.194261551, 7.670791626, 7.335062981, 7.170888901, 7.054496765, 6.962110519, 6.886018276, 6.837729931]
# our_13b_acc = [0.66219152, 0.682863029, 0.691083918, 0.710422927, 0.715917286, 0.71687743, 0.725760049, 0.722983757 ,0.727874139, 0.728116507]

# axes[1].scatter(pbllm_13b_bits, pbllm_13b_c4, label='PB-LLM', s=5, facecolors='none')
# # axes[1].scatter(owq_13b_bits, owq_13b_c4, label='OWQ', s=5,)
# axes[1].scatter(bitstack_13b_bits, bitstack_13b_c4, label='BitStack', s=5, facecolors='none')
# axes[1].scatter(our_13b_bits, our_13b_c4, label='Our', s=5, facecolors='none')
# axes[1].set_title('Llama 2 13B')
# axes[1].set_xlabel('Bits')
# axes[1].set_ylabel('Perplexity')
# axes[1].grid(c='0.8')
# # axes[0].legend(loc='upper right')
# axes[1].legend()
# axes[1].set_yscale('log')

# ax = axes[1].twinx()
# ax.scatter(pbllm_13b_bits, pbllm_13b_acc, s=5)
# # ax.scatter(owq_13b_bits, owq_13b_acc, s=5)
# ax.scatter(bitstack_13b_bits, bitstack_13b_acc, s=5)
# ax.scatter(our_13b_bits, our_13b_acc, s=5)
# ax.set_ylabel('Acc.')
# ax.grid(c='0.8')

# bitstack_70b_bits = [2.2, 2.4, 2.6, 2.8, 3, 3.2, 3.4, 3.6, 3.8, 4]
# bitstack_70b_w2 = [4.974086285, 4.728073597,  4.493756294, 4.278894424, 4.069427013, 3.967707634, 3.888819456, 3.816739559, 3.747808456, 3.707520008]
# bitstack_70b_c4 = [7.515676975, 7.180526733, 6.885457039, 6.638876915, 6.431142807, 6.316576004, 6.232776165, 6.160410404, 6.090384483, 6.057357311]
# bitstack_70b_acc = [0.728957305, 0.733191138, 0.74534594, 0.756955741, 0.764177957, 0.764116636, 0.765076091, 0.767906965, 0.769242697, 0.771363724]


# fig.tight_layout() 
# plt.savefig(fig_path, dpi=300)

import numpy as np
from matplotlib import pyplot as plt

# owq_llama_2_gemv_hf

# 표로 그릴 것.

colors = [
    '#FF6663',
    '#939393',
    '#C83C04',
    '#378375',
    '#6699FF',
    '#FACA00',
    '#2351AB',
]

# fig_path='acl/experiment/continous_result.png'
fig_path = '/NAS/SJ/nsgaquant/acl/experiment/continuous_result.png'

font = {'size'   : 13}
plt.rc('font', **font)
plt.rc('axes', axisbelow=True)

linewidth = 2
markersize = 6

fig, axes = plt.subplots(nrows=1, ncols=3, figsize=(20, 5)) 
fig.subplots_adjust(hspace=0.5, wspace=0.1)

our_7b_bits = np.array([2.10395078, 2.20369171, 2.254047927, 2.40349741, 2.50259067, 2.60427461, 2.75372409, 2.80246114, 2.99740933, 3.10249352, 3.20498705, 3.25194301, 3.40123057, 3.50291451, 3.60103627, 3.75275259, 3.80310881, 3.99222798]) + 0.25
our_7b_w2 = [11.08965874, 9.70293808, 9.225644112, 8.307990074, 7.857845783, 7.460319519, 6.853315353, 6.713390827, 6.187410831, 6.080403805, 6.020772934, 5.983048916, 5.869136333, 5.8397789, 5.793658257, 5.705946922, 5.68144989, 5.597347736]
our_7b_c4 = [14.62360764, 12.82921791, 12.24621773, 10.93458462, 10.40924454, 9.837593079, 9.070055962, 8.866043091, 8.225736618, 8.101255417, 8.009811401, 7.973155499, 7.793493271, 7.715877056, 7.64744854, 7.556500912, 7.530736923, 7.44137764]
our_7b_acc = np.array([0.579951282, 0.604282098, 0.610942152, 0.625704665, 0.636528213, 0.637907708, 0.662299114, 0.666701336, 0.677821555, 0.680930553, 0.682099624, 0.684146233, 0.686616407, 0.685500533, 0.686102525, 0.690475559, 0.688649375, 0.697427872])

bitstack_7b_bits = np.array([2.2, 2.25, 2.4, 2.5, 2.6, 2.75, 2.8, 3, 3.2, 3.4, 3.5, 3.6, 3.25, 3.8, 4]) + 0.25
bitstack_7b_w2 = [9.175833702, 8.919683456, 8.297012329, 8.030778885, 7.791053772, 7.46325016, 7.414270401, 7.098052025, 6.766305923, 6.555026531, 6.49548769, 6.430410385, 6.716687202, 6.334755898, 6.266643047]
bitstack_7b_c4 = [12.56320381,12.08555031,11.26459026,10.89515114,10.59273624,10.1287241,10.04853344,9.664886475,9.113240242,8.809690475,8.72145462,8.641955376,9.035755157,8.511131287,8.385821342]
bitstack_7b_acc = np.array([0.601391018, 0.599096365, 0.619275265, 0.6232738, 0.627521764, 0.63626589, 0.637491537, 0.643394393, 0.656135069, 0.662427668, 0.664995169, 0.667206655, 0.655437051, 0.672052206, 0.674013289])

pbllm_7b_bits = np.array([2.197, 2.4, 2.603, 2.799, 3.002, 3.198, 3.401, 3.597, 3.8, 4.003]) + 0.25
pbllm_7b_w2 = [25.409021, 17.224394, 13.824484, 11.35747, 9.181018, 8.061, 7.414878, 6.925223, 6.602927, 6.332662]
pbllm_7b_c4 = [32.068573, 22.882645, 17.609436, 14.669633, 12.173552, 10.701463, 9.805017, 9.174158, 8.767661, 8.437231]
pbllm_7b_acc = np.array([0.439466138, 0.480417192, 0.536299553, 0.578924823, 0.613636868, 0.634068865, 0.646246926, 0.659146108, 0.673270014, 0.678828369])

owq_7b_bits = np.array([2.001, 2.197, 2.253, 2.4, 2.498, 2.603, 2.75, 2.799, 3.002, 3.198, 3.247, 3.401, 3.499, 3.597, 3.8, 4.003]) + 0.25
owq_7b_w2 = [37.424191, 25.409021, 24.530106, 17.224394, 15.213892, 13.824484, 11.599681, 11.35747, 9.181018, 8.061, 7.895278, 7.414878, 7.09116, 6.925223, 6.602927, 6.332662]
owq_7b_c4 = [46.541725, 32.068573, 32.053589, 22.882645, 20.006735, 17.609436, 14.805572, 14.669633, 12.173552, 10.701463, 10.400482, 9.805017, 9.421015, 9.174158, 8.767661, 8.437231]
owq_7b_acc = np.array([0.417384248, 0.439466138, 0.44401668, 0.480417192, 0.512902388, 0.536299553, 0.565292505, 0.578924823, 0.613636868, 0.634068865, 0.641243131, 0.646246926, 0.653657637, 0.659146108, 0.673270014, 0.678828369])

# w2g128, w3, w3g128, w4, w4g128
# discrete_memory = [2238, 2822, 3010, 3594, 3782]
# awq_7b_w2 = [222695.0469, 15.44975281, 6.245078087, 5.832165241, 5.598873138]
# awq_7b_c4 = [168670.7188, 17.44231033, 8.3010149, 7.720488548, 7.441966534]
# awq_7b_acc = np.array([36.11638305, 54.67185085, 67.62783576, 69.09897888, 69.90155773])

# gptq_7b_w2 = [61.76620483, 9.274932861, 6.446384907, 6.093852997, 5.642832279]
# gptq_7b_c4 = [44.10067749, 11.81025696, 8.531720161, 7.857592583, 7.523168087]
# gptq_7b_acc = np.array([43.19096879, 60.69622798, 67.22225115, 68.55015288, 69.04313609])

axes[0].plot(pbllm_7b_bits, pbllm_7b_c4, label='PB-LLM', marker='o', markersize=markersize, linewidth=linewidth, c = colors[3])
axes[0].plot(bitstack_7b_bits, bitstack_7b_c4, label='BitStack', marker='o', markersize=markersize, linewidth=linewidth, c = 'orange')
axes[0].plot(our_7b_bits, our_7b_c4, label='AMQ', marker='o', markersize=markersize, linewidth=linewidth, c = 'red')
# axes[0].scatter(discrete_memory[1:], awq_7b_c4[1:], label='AWQ', s=40, c=colors[4])
# axes[0].scatter(discrete_memory[1:], gptq_7b_c4[1:], label='GPTQ', s=40, c=colors[3])
axes[0].grid(c='0.8')

ax = axes[0].twinx()
ax.plot(pbllm_7b_bits, 100 * pbllm_7b_acc, linestyle = '--', marker='o', markersize=markersize, linewidth=linewidth, c = colors[3])
ax.plot(bitstack_7b_bits, 100 * bitstack_7b_acc, linestyle = '--', marker='o', markersize=markersize, linewidth=linewidth, c = 'orange')
ax.plot(our_7b_bits, 100 * our_7b_acc, linestyle = '--', marker='o', markersize=markersize, linewidth=linewidth, c = 'red', zorder = 3)
# ax.scatter(discrete_memory[1:], awq_7b_acc[1:], s=40, c=colors[4], marker='x')
# ax.scatter(discrete_memory[1:], gptq_7b_acc[1:], s=40, c=colors[3], marker='x')
# ax.grid(c='0.8')
ax.set_xticks([2.25, 2.75, 3.25, 3.75, 4.25])

ax.set_yticks(np.linspace(42, 70, 5))
# axes[0].set_yticks(range(0, 35, 5))

ax.tick_params(axis='both', which='major', labelsize=15)
axes[0].tick_params(axis='both', which='major', labelsize=15)


pbllm_13b_bits = np.array([2.001, 2.197, 2.253, 2.4, 2.498, 2.603, 2.75, 2.799, 3.002, 3.198, 3.247, 3.401, 3.499, 3.597, 3.8, 4.003]) + 0.25
pbllm_13b_w2 = [70.201988, 49.662487, 32.704044, 21.767782, 15.748631, 12.027323, 9.572448, 9.540066, 7.770907, 6.957156, 6.786724, 6.444432, 6.197367, 6.03354, 5.794348, 5.621876]
pbllm_13b_c4 = [76.811501, 53.145523, 42.495216, 28.799479, 21.833565, 16.243132, 13.296763, 13.139219, 10.783956, 9.700974, 9.440514, 8.908892, 8.523313, 8.274727, 7.935522, 7.717345]
pbllm_13b_acc = np.array([0.411433171, 0.445306741, 0.465469785, 0.521918144, 0.582221528, 0.608104881, 0.634757553, 0.64488449, 0.671657683, 0.683852428, 0.686756827, 0.695484065, 0.706756403, 0.708052548, 0.717220212, 0.713828894])

owq_13b_bits = np.array([2.2, 2.4, 2.6, 2.8, 3.2, 3.4, 3.6, 3.8]) * 1512.5 + 378.125 + 625 + 0.791015625
owq_13b_w2 = [8.141159058, 7.90238905, 7.906852245, 7.644672871, 5.259451866, 5.233787537, 5.246657372, 5.222622395]
owq_13b_c4 = [10.81324387, 10.55164051, 10.35543156, 10.24857807, 7.184574127, 7.174242496, 7.165292263, 7.144797802]
owq_13b_acc = np.array([0.649320442, 0.64854396, 0.652410135, 0.660048735, 0.718132311, 0.716591034, 0.724292107, 0.719481134])

bitstack_13b_bits = np.array([2.1, 2.2, 2.25, 2.4, 2.5, 2.6, 2.75, 2.8, 3, 3.2, 3.25, 3.4, 3.5, 3.6, 3.8, 4]) + 0.25
bitstack_13b_w2 = [8.028745651, 7.592807293, 7.456870079, 6.886278152, 6.674023628, 6.534313202, 6.332436562, 6.283027649, 6.042622089, 5.793498993, 5.760062218, 5.671768665, 5.621623516, 5.578070641, 5.509950161, 5.4714818]
bitstack_13b_c4 = [10.8984251, 10.31787777, 10.13041687, 9.537553787, 9.237815857, 9.025455475, 8.73268795, 8.665048599, 8.353291512, 7.974319458, 7.92961359, 7.801470757, 7.7389431, 7.675413132, 7.572425842, 7.49377346]
bitstack_13b_acc = np.array([0.632752944, 0.646154821, 0.652069036, 0.671499793, 0.681265789, 0.687761946, 0.692470769, 0.693403778, 0.704266588, 0.708421695, 0.708730449, 0.714242304, 0.714063108, 0.715914363, 0.720499593, 0.719499094])

our_13b_bits = np.array([2.104545455, 2.20309917, 2.25454545, 2.40061983, 2.50433884, 2.60392562, 2.74938017, 2.80206612, 3.00165289, 3.10371901, 3.20392562, 3.25454545, 3.40123967, 3.50061983, 3.60392562, 3.75475207, 3.80041322, 3.98615702]) + 0.25
our_13b_w2 = [7.71299839, 7.209764004, 6.960026741, 6.441867828, 6.211341858, 5.988779068, 5.742465019, 5.634430885, 5.374492168, 5.304297924, 5.24823761, 5.228238106, 5.157777786, 5.128776073, 5.090263367, 5.030594826, 5.024534225, 4.965404987]
our_13b_c4 = [10.42893791, 9.835852623, 9.534765244, 8.829443932, 8.517198563, 8.194261551, 7.803359032, 7.670791626, 7.335062981, 7.241182327, 7.170888901, 7.136387348, 7.054496765, 7.015735626, 6.962110519, 6.897399902, 6.886018276, 6.837729931]
our_13b_acc = np.array([0.641908905, 0.66219152, 0.665796602, 0.682863029, 0.689958569, 0.691083918, 0.703693136, 0.710422927, 0.715917286, 0.718818017, 0.71687743, 0.72231014, 0.725760049, 0.724154011, 0.722983757, 0.728700119, 0.727874139, 0.728116507]) 

discrete_bit = [2.0, 3.0, 4.0]

# axes[1].plot([3], [7.09], label='C4 PPL', linestyle='-', c='black')
# axes[1].plot([3], [7.09], label='Zero-shot Average', linestyle='--', c='black')

axes[1].plot(our_13b_bits, our_13b_c4, label='AMQ', marker='o', markersize=markersize, linewidth=linewidth, c = 'red')
axes[1].plot(bitstack_13b_bits, bitstack_13b_c4, label='BitStack', marker='o', markersize=markersize, linewidth=linewidth, c = 'orange')
axes[1].plot(pbllm_13b_bits, pbllm_13b_c4, label='PB-LLM', marker='o', markersize=markersize, linewidth=linewidth, c = colors[3])
# axes[1].scatter(owq_13b_bits, owq_13b_c4, label='OWQ', s=5,)
# axes[1].set_title('Llama-2 13B')
# axes[1].set_xlabel('Bits')
# axes[1].set_ylabel('Perplexity')
axes[1].grid(c='0.8')
# axes[0].legend(loc='upper right')
# axes[1].legend()
# axes[1].set_yscale('log')

ax = axes[1].twinx()

ax.plot(pbllm_13b_bits, 100 * pbllm_13b_acc, linestyle = '--', marker='o', markersize=markersize, linewidth=linewidth, c = colors[3])
# ax.scatter(owq_13b_bits, owq_13b_acc, s=5)
ax.plot(bitstack_13b_bits, 100 * bitstack_13b_acc, linestyle = '--', marker='o', markersize=markersize, linewidth=linewidth, c = 'orange', zorder=1)
ax.plot(our_13b_bits, 100 * our_13b_acc, linestyle = '--', marker='o', markersize=markersize, linewidth=linewidth, c = 'red', zorder = 3)
# ax.set_ylabel('Acc.')
# ax.grid(c='0.8')
ax.set_xticks([2.25, 2.75, 3.25, 3.75, 4.25])
# ax.legend(['C4 PPL', 'Zero-shot Average'], loc='upper center', fontsize=15, ncol=2, bbox_to_anchor=(0.5, 1.315))
# axes[1].legend(['AMQ', 'BitStack', 'PB-LLM'], loc='upper center', fontsize=15, ncol=5, bbox_to_anchor=(0.5, 1.2))

# ax.plot(0, 0, linestyle = '-', c='black', label='C4 PPL')
# ax.plot(0, 0, linestyle = '--', c='black', label='Zero-shot Average')
# ax.legend(loc='upper center', fontsize=15, ncol=2, bbox_to_anchor=(0.5, 1.315))

ax.set_yticks(np.linspace(42, 74, 5))
axes[1].set_yticks(np.linspace(7, 83, 5))

ax.tick_params(axis='both', which='major', labelsize=15)
axes[1].tick_params(axis='both', which='major', labelsize=15)


bitstack_70b_bits = np.array([2.2, 2.25, 2.4, 2.5, 2.6, 2.75, 2.8, 3, 3.2, 3.25, 3.4, 3.5, 3.6, 3.8, 4]) + 0.25
bitstack_70b_w2 = [4.974086285, 4.913050175, 4.728073597, 4.609647274, 4.493756294, 4.337579727, 4.278894424, 4.069427013, 3.967707634, 3.948377371, 3.888819456, 3.85209775, 3.816739559, 3.747808456, 3.707520008]
bitstack_70b_c4 = [7.515676975, 7.428258896, 7.180526733, 7.02868557, 6.885457039, 6.692698956, 6.638876915, 6.431142807, 6.316576004, 6.296806335, 6.232776165, 6.192120552, 6.160410404, 6.090384483, 6.057357311]
bitstack_70b_acc = [0.728957305, 0.729200041, 0.733191138, 0.74070795, 0.74534594, 0.75440601, 0.756955741, 0.764177957, 0.764116636, 0.764960504, 0.765076091, 0.765944262, 0.767906965, 0.769242697, 0.771363724]
bitstack_70b_acc = np.array(bitstack_70b_acc)

our_70b_bits = np.array([2.104411765, 2.20306373, 2.25281863, 2.40490196, 2.50367647, 2.60294118, 2.753063725, 2.80416667, 3.00343137, 3.10355392, 3.20294118, 3.25036765, 3.40490196, 3.49852941, 3.60465686, 3.74840686, 3.79730392, 3.987377451]) + 0.25
our_70b_w2 = [5.175560951, 4.993602276, 4.893946171, 4.576478481, 4.422606468, 4.275177956, 4.034964085, 3.963034868, 3.724072933, 3.667384624, 3.627696037, 3.605181217, 3.550760746, 3.52549696, 3.496205807, 3.456231833, 3.445744038, 3.410032511]
our_70b_c4 = [7.627700806, 7.389309883, 7.246460438, 6.886165619, 6.714670658, 6.535670757, 6.30312109, 6.232421398, 6.018145561, 5.971095562, 5.942317963, 5.922836781, 5.87950182, 5.860199928, 5.835152149, 5.808598518, 5.799371719, 5.773358345]
our_70b_acc = [0.737667448, 0.738021299, 0.744922683, 0.743657972, 0.753498046, 0.755443093, 0.762817355, 0.76499475, 0.766131804, 0.76751751, 0.769627149, 0.769929044, 0.768681573, 0.771572233, 0.772659542, 0.772436607, 0.773729407, 0.776231165]
our_70b_acc = np.array(our_70b_acc)

axes[2].plot(our_70b_bits, our_70b_c4, label='AMQ', marker='o', markersize=markersize, linewidth=linewidth, c = 'red')
# axes[2].plot(pbllm_70b_bits, pbllm_70b_c4, label='PB-LLM', marker='o', markersize=markersize, linewidth=linewidth, c = colors[2])
axes[2].plot(bitstack_70b_bits, bitstack_70b_c4, label='BitStack', marker='o', markersize=markersize, linewidth=linewidth, c = 'orange')
axes[2].grid(c='0.8')

ax = axes[2].twinx()
ax.plot(our_70b_bits, 100 * our_70b_acc, linestyle = '--', marker='o', markersize=markersize, linewidth=linewidth, c = 'red', zorder = 3)
# ax.plot(pbllm_70b_bits, 100 * pbllm_70b_acc, linestyle = '--', marker='o', markersize=markersize, linewidth=linewidth, c = colors[2])
ax.plot(bitstack_70b_bits, 100 * bitstack_70b_acc, linestyle = '--', marker='o', markersize=markersize, linewidth=linewidth, c = 'orange')
# ax.grid(c='0.8')
ax.set_xticks([2.25, 2.75, 3.25, 3.75, 4.25])

ax.set_yticks(np.linspace(71, 79, 5))
axes[2].set_yticks(np.linspace(5, 9, 5))

ax.tick_params(axis='both', which='major', labelsize=15)
axes[2].tick_params(axis='both', which='major', labelsize=15)

fig.tight_layout() 
plt.savefig(fig_path, dpi=300)
